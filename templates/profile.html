<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Profile | Vetana</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg:#121212;
  --accent-cyan:#00D4FF;
  --electric:#00FF85;
  --text:#E6EEF3;
  --muted:#9AA6B2;
}

body {
  margin:0;
  font-family:"Poppins", sans-serif;
  background:url("{{ url_for('static', filename='app8.jpg') }}") no-repeat center/cover;
  color:var(--text);
  min-height:100vh;
}
.overlay {
  background:rgba(0,0,0,0.75);
  min-height:100vh;
  padding:40px 20px;
}

.profile-card {
  width:min(700px, 95%);
  margin:auto;
  background:rgba(255,255,255,0.05);
  padding:25px;
  border-radius:18px;
  backdrop-filter:blur(10px);
}

/* Avatar */
.avatar {
  width:110px;
  height:110px;
  border-radius:50%;
  border:3px solid var(--accent-cyan);
  background:linear-gradient(145deg, var(--accent-cyan), var(--electric));
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:45px;
  font-family:"Orbitron";
  margin:auto;
}

/* Profile Table Styling */
.profile-table {
  width:90%;
  margin:25px auto;
  border-collapse:separate;
  border-spacing:0 12px;
}

.profile-table td {
  padding:14px 16px;
  background:rgba(255,255,255,0.04);
  border-radius:10px;
  font-size:16px;
}

/* Buttons */
.back-btn-container {
  text-align:center;
  margin-top:25px;
}

.back-btn {
  background:none;
  border:1px solid var(--accent-cyan);
  color:var(--accent-cyan);
  padding:10px 18px;
  border-radius:12px;
}

/* Modal */
.modal-bg {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal-box {
  width:min(500px,95%);
  background:#1b1b1b;
  padding:25px;
  border-radius:16px;
}

.modal-box input, 
.modal-box textarea {
  width:100%;
  padding:10px;
  border-radius:10px;
  margin-bottom:10px;
  background:#0f0f0f;
  color:white;
}

.save-btn {
  width:100%;
  padding:12px;
  background:linear-gradient(90deg,var(--accent-cyan),var(--electric));
  border:none;
  border-radius:12px;
}

/* Error Message */
.error-msg {
  color:#ff4e4e;
  font-size:13px;
  margin-top:-8px;
  margin-bottom:8px;
}
</style>
</head>

<body>
<div class="overlay">

<div class="profile-card">

  <!-- Avatar -->
  <div class="avatar">
    {{ account.username[0].upper() }}
  </div>

  <h2 style="text-align:center;font-family:Orbitron;color:var(--accent-cyan);margin-top:10px;">
    My Profile <span style="cursor:pointer;" onclick="openModal()">✏️</span>
  </h2>

  <!-- Profile Display Table -->
  <table class="profile-table">
    <tr><td><b>Username:</b> {{ account.username }}</td></tr>
    <tr><td><b>Full Name:</b> {{ account.fullname }}</td></tr>
    <tr><td><b>Phone:</b> {{ account.contact }}</td></tr>

    {% if user %}
      <tr><td><b>Location:</b> {{ user.location }}</td></tr>
      <tr><td><b>Service Required:</b> {{ user.job_requirements }}</td></tr>
      <tr><td><b>Date Needed:</b> {{ user.date_needed }}</td></tr>
      <tr><td><b>Start Time:</b> {{ user.start_time }}</td></tr>
      <tr><td><b>End Time:</b> {{ user.end_time }}</td></tr>
      <tr><td><b>Duration:</b> {{ user.duration }}</td></tr>
      <tr><td><b>Special Requirements:</b> {{ user.special_requirements }}</td></tr>
    {% endif %}

    {% if worker %}
      <tr><td><b>Gender:</b> {{ worker.gender }}</td></tr>
      <tr><td><b>Age:</b> {{ worker.age }}</td></tr>
      <tr><td><b>Type of Work:</b> {{ worker.type_of_work }}</td></tr>
      <tr><td><b>Availability:</b> {{ worker.availability }}</td></tr>
      <tr><td><b>Income Preference:</b> {{ worker.income_pref }}</td></tr>
      <tr><td><b>Expected Pay:</b> {{ worker.expected_pay }}</td></tr>
      <tr><td><b>Location:</b> {{ worker.location }}</td></tr>
      <tr><td><b>Languages Known:</b> {{ worker.languages_known }}</td></tr>
    {% endif %}
  </table>

  <!-- ⚠️ NOTIFICATIONS REMOVED COMPLETELY -->
  <!-- NOTHING WILL SHOW HERE NOW -->

  <!-- Back Button -->
  <div class="back-btn-container">
    <button class="back-btn" onclick="location.href='{{ url_for('home') }}'">← Go Back</button>
  </div>

</div>
</div>

<!-- Modal -->
<div class="modal-bg" id="editModal">
  <div class="modal-box">
    <h3 style="color:var(--accent-cyan);font-family:Orbitron;">Edit Profile</h3>

    <form method="POST" action="{{ url_for('update_profile') }}" onsubmit="return validateForm()">

      <input type="text" name="username" value="{{ account.username }}" placeholder="Username">
      <input type="text" name="fullname" value="{{ account.fullname }}" placeholder="Full Name">
      <input type="text" name="contact" value="{{ account.contact }}" placeholder="Contact Number" id="mobile">

      <div id="mobileError" class="error-msg"></div>

      {% if user %}
        <input type="text" name="location" value="{{ user.location }}" placeholder="Location">
        <textarea name="job_requirements">{{ user.job_requirements }}</textarea>
        <input type="date" name="date_needed" value="{{ user.date_needed }}">
        <input type="text" name="start_time" value="{{ user.start_time }}" placeholder="Start Time">
        <input type="text" name="end_time" value="{{ user.end_time }}" placeholder="End Time">
        <input type="text" name="duration" value="{{ user.duration }}" placeholder="weekly/monthly">
        <textarea name="special_requirements">{{ user.special_requirements }}</textarea>
      {% endif %}

      {% if worker %}
        <input type="text" name="gender" value="{{ worker.gender }}" placeholder="Gender">
        <input type="text" name="age" value="{{ worker.age }}" placeholder="Age">
        <input type="text" name="type_of_work" value="{{ worker.type_of_work }}" placeholder="Type of Work">
        <input type="text" name="availability" value="{{ worker.availability }}" placeholder="Availability">
        <input type="text" name="income_pref" value="{{ worker.income_pref }}" placeholder="Income Preference">
        <input type="text" name="expected_pay" value="{{ worker.expected_pay }}" placeholder="Expected Pay">
        <input type="text" name="location" value="{{ worker.location }}" placeholder="Location">
        <textarea name="languages_known">{{ worker.languages_known }}</textarea>
      {% endif %}

      <button class="save-btn">Save Changes</button>

    </form>
  </div>
</div>

<script>
function openModal(){
  document.getElementById("editModal").style.display="flex";
}

window.onclick = function(e){
  if(e.target === document.getElementById("editModal")){
    document.getElementById("editModal").style.display="none";
  }
}

function validateForm() {
  let mobile = document.getElementById("mobile");
  let error = document.getElementById("mobileError");
  error.innerHTML = "";

  if (!/^[0-9]{10}$/.test(mobile.value)) {
    error.innerHTML = "Enter a valid 10-digit mobile number.";
    return false;
  }
  return true;
}
</script>

</body>
</html>
